import{d as w,r as f,u as B,b as D,e as F,c as g,f as p,j as e,h as o,aI as P,k as a,V as r,l as T,i as v,F as S,o as m,g as d,p as E,t as q,b4 as N,x as Q,A as I,B as L,C as $}from"./index-sE9P4Q9O.js";import{g as j,d as z}from"./coupons-service-3blLbs3l.js";import{d as K}from"./index-AJYIkLwR.js";import{V as M,L as U}from"./VDataTableServer-KxNtiX_H.js";import{d as A}from"./format-date-q9jp0Fy1.js";import{_ as O}from"./DeleteIcon.vue_vue_type_script_setup_true_lang-1ZPx5IJG.js";import{V as G}from"./VDialog-1Ku-f6d7.js";import{V as H}from"./VSpacer-1dX4bruf.js";import"./queryString-AL1HqB06.js";import"./formData-AERYmAuJ.js";import"./_commonjsHelpers-5-cIlDoe.js";import"./filter-ySkqEX_B.js";const J=p("h2",{class:"text-2xl font-semibold"}," الكوبونات ",-1),R={class:"flex justify-between mt-8"},W={class:"w-72"},X={key:1,class:"shadow-lg rounded-lg mt-4 border border-gray-200"},Y={class:"flex gap-2"},ce=w({__name:"CouponsList",setup(Z){const c=f(""),s=f({page:1,limit:10,coupon_code:""}),n=B({queryKey:["coupones",s],queryFn:()=>j(s.value)}),_=[{title:"الكود",value:"coupon_code",width:"300px",sortable:!1},{title:"الحد الأعلي",value:"limit",width:"300px",sortable:!1},{title:"نسبة التخفيض",value:"discount_percentage",width:"300px",sortable:!1},{title:"تاريخ إنتهاء الصلاحية",key:"expireDate",value:"expire_date",width:"300px",sortable:!1},{title:"الإجرائات",key:"actions",width:"300px",sortable:!1}],x=({page:l,limit:i})=>{s.value={...s.value,page:l??1,limit:i??10}},y=K(()=>{s.value.coupon_code=c.value},300),h=D(),C=F({mutationFn:z,onSuccess:()=>{h.invalidateQueries({queryKey:["coupones"]})},onError:l=>{console.log(l)}}),V=l=>{C.mutate(l)},b=l=>`حذف الكوبون ${l}# ?`;return(l,i)=>(m(),g(S,null,[J,p("div",R,[p("div",W,[e(P,{modelValue:c.value,"onUpdate:modelValue":i[0]||(i[0]=t=>c.value=t),label:"البحث",variant:"outlined",color:"primary",clearable:"",placeholder:"البحث",density:"compact",onInput:o(y)},null,8,["modelValue","onInput"])]),e(r,{"append-icon":o(E),to:{name:"add-coupon"},color:"primary",variant:"elevated",rounded:"xl"},{default:a(()=>[d(" إضافة كوبون ")]),_:1},8,["append-icon"])]),o(n).isPending.value?(m(),T(U,{key:0})):v("",!0),o(n).data.value?(m(),g("div",X,[e(M,{sticky:"","items-per-page":s.value.limit,page:s.value.page,headers:_,"items-length":o(n).data.value.total,items:o(n).data.value.data,loading:o(n).isPending.value,"onUpdate:options":i[1]||(i[1]=t=>x({page:t.page,limit:t.itemsPerPage}))},{"item.expireDate":a(({item:t})=>[d(q(o(A)(t.expire_date)),1)]),"item.actions":a(({item:t})=>[p("div",Y,[e(r,{"append-icon":o(N),color:"grey-darken-2",size:"small",variant:"elevated",to:{name:"edit-coupon",params:{id:t.id}}},{default:a(()=>[d(" تعديل ")]),_:2},1032,["append-icon","to"]),e(G,{width:"500"},{activator:a(({props:u})=>[e(r,Q(u,{size:"small",variant:"elevated",color:"#004C6B",type:"submit"}),{prepend:a(()=>[e(O,{fill:"fill-white"})]),default:a(()=>[d(" حذف ")]),_:2},1040)]),default:a(({isActive:u})=>[e(I,{title:b(t.coupon_code),rounded:"lg",color:"#EFE9F5",style:{"padding-block":"1.75rem !important"}},{default:a(()=>[e(L,null,{default:a(()=>[d(" سيتم حذف هذه الكوبون بشكل نهائي . ")]),_:1}),e($,null,{default:a(()=>[e(H),e(r,{text:"لا",onClick:k=>u.value=!1},null,8,["onClick"]),e(r,{text:"نعم",onClick:k=>{u.value=!1,V(t.id)}},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["title"])]),_:2},1024)])]),_:2},1032,["items-per-page","page","items-length","items","loading"])])):v("",!0)],64))}});export{ce as default};
