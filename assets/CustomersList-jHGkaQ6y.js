import{g as j,c as F,a as G}from"./customers-service-e-BWXCQk.js";import{d as O,r as C,b as z,u as H,aG as J,c as f,f as V,g as v,h as t,t as S,i as c,j as a,aI as M,l as _,k as o,o as i,V as y,y as h,aQ as R,s as E,D as I,E as P}from"./index-sE9P4Q9O.js";import{V as W,L as X}from"./VDataTableServer-KxNtiX_H.js";import{_ as Y}from"./EmptyData.vue_vue_type_script_setup_true_lang-h7VAi8C4.js";import{B as n}from"./base-status-k7rMfTbK.js";import{d as Z}from"./index-AJYIkLwR.js";import{V as b}from"./VTooltip-RkjaeBLA.js";import"./queryString-AL1HqB06.js";import"./filter-ySkqEX_B.js";import"./_commonjsHelpers-5-cIlDoe.js";const tt={class:"text-3xl font-medium mt-6"},et={key:0,class:"bg-gray-200 px-2 rounded-lg text-2xl"},at={class:"flex justify-between"},ot={class:"w-72 mt-8"},lt={key:0},st={key:1,class:"mt-8"},it={key:1,class:"shadow-lg rounded-lg mt-4 border border-gray-200"},nt={class:"flex gap-2"},ht=O({__name:"CustomersList",setup(rt){const Q=[{title:"إسم الزبون",value:"name",width:"300px",sortable:!1},{title:"الإيميل الإلكتروني",value:"email",width:"300px",sortable:!1},{title:"رقم الهاتف",value:"phone_number",width:"300px",sortable:!1},{title:"الإجرائات",key:"actions",width:"300px",sortable:!1},{title:"الحالة",key:"status",value:"is_active",width:"300px",sortable:!1},{title:"هل المستخدم موثوق به",key:"is_trusted",value:"is_trusted",width:"300px",sortable:!1}],d=C([]),w=C([]),k=C(""),p=C({page:1,limit:10,search_value:""}),T=z(),r=H({queryKey:["customers",p],queryFn:()=>j(p.value,k.value)}),N=({page:l,limit:s})=>{p.value={...p.value,page:l??1,limit:s??10}},U=Z(()=>{p.value.search_value=k.value},300),A=(l,s,m)=>{d.value[m]=!0,F({id:l,is_active:s}).then(()=>T.invalidateQueries({queryKey:["customers"]})).finally(()=>d.value[m]=!1)},B=(l,s,m)=>{d.value[m]=!0,G({id:l,is_trusted:s}).then(()=>T.invalidateQueries({queryKey:["customers"]})).finally(()=>d.value[m]=!1)},D=l=>l===n.Activated?"success":"error",$=l=>l===n.Activated?"مفعل":"غير مفعل",K=l=>l===n.Activated?"موثوق":"غير موثوق";return J(()=>{console.log(w.value)}),(l,s)=>{var m,L,q;return i(),f("div",null,[V("h1",tt,[v(" الزبائن "),(m=t(r).data.value)!=null&&m.total?(i(),f("span",et,S((L=t(r).data.value)==null?void 0:L.total),1)):c("",!0)]),V("div",at,[V("div",ot,[a(M,{modelValue:k.value,"onUpdate:modelValue":s[0]||(s[0]=e=>k.value=e),label:"البحث",variant:"outlined",color:"primary",clearable:"",placeholder:"البحث",density:"compact",onInput:t(U)},null,8,["modelValue","onInput"])])]),(q=t(r).data.value)!=null&&q.data?c("",!0):(i(),f("div",lt,[t(r).isPending.value?(i(),_(X,{key:0})):c("",!0)])),t(r).data.value?(i(),f("div",st,[t(r).data.value.data.length===0?(i(),_(Y,{key:0})):c("",!0),t(r).data.value?(i(),f("div",it,[a(W,{modelValue:w.value,"onUpdate:modelValue":s[1]||(s[1]=e=>w.value=e),sticky:"","items-per-page":p.value.limit,page:p.value.page,headers:Q,"items-length":t(r).data.value.total,items:t(r).data.value.data,loading:t(r).isPending.value,"show-select":"","item-value":"id","onUpdate:options":s[2]||(s[2]=e=>N({page:e.page,limit:e.itemsPerPage}))},{"item.actions":o(({item:e})=>[a(y,{to:{name:"view-customer",params:{customerId:e.id}},variant:"tonal",class:"mx-1",density:"comfortable",icon:"",color:"primary"},{default:o(()=>[a(h,{icon:t(R)},null,8,["icon"]),a(b,{activator:"parent",location:"bottom"},{default:o(()=>[v(" عرض ")]),_:1})]),_:2},1032,["to"])]),"item.status":o(({value:e,item:u,index:g})=>[a(E,{color:D(e)},{default:o(()=>[v(S($(e)),1)]),_:2},1032,["color"]),u.is_active===t(n).Activated?(i(),_(y,{key:0,loading:d.value[g],variant:"tonal",class:"mx-1",density:"comfortable",icon:"",color:"warning",onClick:x=>A(u.id,t(n).Deactivated,g)},{default:o(()=>[a(h,{icon:t(I)},null,8,["icon"]),a(b,{activator:"parent",location:"bottom"},{default:o(()=>[v(" الغاء التفعيل ")]),_:1})]),_:2},1032,["loading","onClick"])):c("",!0),u.is_active===t(n).Deactivated?(i(),_(y,{key:1,loading:d.value[g],variant:"tonal",class:"mx-1",density:"comfortable",icon:"",color:"success",onClick:x=>A(u.id,t(n).Activated,g)},{default:o(()=>[a(h,{icon:t(P)},null,8,["icon"]),a(b,{activator:"parent",location:"bottom"},{default:o(()=>[v(" إعادة التفعيل ")]),_:1})]),_:2},1032,["loading","onClick"])):c("",!0)]),"item.is_trusted":o(({item:e,index:u,value:g})=>[V("div",nt,[a(E,{color:D(g)},{default:o(()=>[v(S(K(g)),1)]),_:2},1032,["color"]),e.is_trusted===t(n).Activated?(i(),_(y,{key:0,loading:d.value[u],variant:"tonal",class:"mx-1",density:"comfortable",icon:"",color:"warning",onClick:x=>B(e.id,t(n).Deactivated,u)},{default:o(()=>[a(h,{icon:t(I)},null,8,["icon"]),a(b,{activator:"parent",location:"bottom"},{default:o(()=>[v(" الغاء الثقة بالمستخدم ")]),_:1})]),_:2},1032,["loading","onClick"])):c("",!0),e.is_trusted===t(n).Deactivated?(i(),_(y,{key:1,loading:d.value[u],variant:"tonal",class:"mx-1",density:"comfortable",icon:"",color:"success",onClick:x=>B(e.id,t(n).Activated,u)},{default:o(()=>[a(h,{icon:t(P)},null,8,["icon"]),a(b,{activator:"parent",location:"bottom"},{default:o(()=>[v(" تحويل إلي مستخدم موثوق ")]),_:1})]),_:2},1032,["loading","onClick"])):c("",!0)])]),_:2},1032,["modelValue","items-per-page","page","items-length","items","loading"])])):c("",!0)])):c("",!0)])}}});export{ht as default};
