import{d as w,r as S,N as A,u as T,aA as $,aB as z,aD as m,aE as G,aF as c,aG as H,c as C,f as g,j as a,k as l,h as e,aH as p,aI as q,V as D,aJ as J,o as E,aK as B,aL as I,g as v,b as R,e as O,F as W,G as X,H as Y}from"./index-sE9P4Q9O.js";import{p as Z}from"./productDetails-service-ZYZcBagp.js";import{g as ee}from"./markets-service-9CeRDKxI.js";import{g as ae}from"./products-service-rn7XLkah.js";import{V as L}from"./VAutocomplete-OZIwKkOo.js";import"./queryString-AL1HqB06.js";import"./formData-AERYmAuJ.js";import"./filter-ySkqEX_B.js";const te={class:"grid md:grid-cols-2 xl:grid-cols-3 gap-x-8 gap-y-2 mt-6"},se={class:"mt-3"},le=w({__name:"ProductDetailsForm",props:{isLoading:{type:Boolean}},emits:["submit"],setup(V,{emit:y}){const u=V,_=y,o=S("empty");A(()=>!x.value.valid||o.value=="empty");const r=S({page:1,limit:50}),h=T({queryKey:["markets",r],queryFn:()=>ee(r.value)}),K=T({queryKey:["products",r],queryFn:()=>ae(r.value)}),M=$(z({saller_price:m().min(1,"سعر البيع"),inventory:m().min(1,"يجب إدخال الكمية"),market_id:m().min(1,"يجب إختيار المحل"),product_id:m().min(1,"يجب إختيار المنتج")})),{handleSubmit:Q,errors:d,meta:x,setValues:ie}=G({validationSchema:M}),{value:i}=c("saller_price"),{value:n}=c("inventory"),{value:f}=c("market_id"),{value:b}=c("product_id");H(()=>{});const U=()=>{n.value=Number(n.value)},j=()=>{i.value=Number(i.value)},k=Q(F=>{_("submit",{...F})});return(F,t)=>{var N,P;return E(),C("form",{onSubmit:t[4]||(t[4]=J((...s)=>e(k)&&e(k)(...s),["prevent"]))},[g("div",te,[a(L,{modelValue:e(f),"onUpdate:modelValue":t[0]||(t[0]=s=>p(f)?f.value=s:null),"hide-no-data":!1,"item-title":"name","item-value":"id",items:(N=e(h).data.value)==null?void 0:N.data,loading:e(h).isPending.value,"hide-selected":"",label:"المحلات",placeholder:"المحلات",variant:"outlined",color:"primary","auto-select-first":"","error-messages":e(d).market_id},{"no-data":l(()=>[a(B,null,{default:l(()=>[a(I,null,{default:l(()=>[v(" لا توجد نتائج ")]),_:1})]),_:1})]),_:1},8,["modelValue","items","loading","error-messages"]),a(L,{modelValue:e(b),"onUpdate:modelValue":t[1]||(t[1]=s=>p(b)?b.value=s:null),"hide-no-data":!1,"item-title":"name","item-value":"id",items:(P=e(K).data.value)==null?void 0:P.data,"hide-selected":"",label:"المنتجات",placeholder:"المنتجات",variant:"outlined",color:"primary","auto-select-first":"","error-messages":e(d).product_id},{"no-data":l(()=>[a(B,null,{default:l(()=>[a(I,null,{default:l(()=>[v(" لا توجد نتائج ")]),_:1})]),_:1})]),_:1},8,["modelValue","items","error-messages"]),a(q,{modelValue:e(n),"onUpdate:modelValue":t[2]||(t[2]=s=>p(n)?n.value=s:null),label:"الكمية",type:"number",variant:"outlined",color:"primary",placeholder:"الكمية","error-messages":e(d).inventory,onInput:U},null,8,["modelValue","error-messages"]),a(q,{modelValue:e(i),"onUpdate:modelValue":t[3]||(t[3]=s=>p(i)?i.value=s:null),label:"سعر البيع",type:"number",variant:"outlined",color:"primary",placeholder:"سعر البيع","error-messages":e(d).saller_price,onInput:j},null,8,["modelValue","error-messages"])]),g("div",se,[a(D,{disabled:!e(x).valid,size:"large",variant:"elevated",color:"primary",type:"submit",loading:u.isLoading},{default:l(()=>[v(" إضافة ")]),_:1},8,["disabled","loading"])])],32)}}}),oe={class:"flex justify-between"},re=g("h1",{class:"text-2xl font-medium"}," ربط منتج بمحل ",-1),ye=w({__name:"CreateProductDetails",setup(V){const y=R(),u=O({mutationFn:Z,onSuccess:()=>{Y.replace({name:"products-details-list"}),y.invalidateQueries({queryKey:["details"]})},onError:o=>{console.log(o)}}),_=o=>{u.mutate(o)};return(o,r)=>(E(),C(W,null,[g("div",oe,[re,a(D,{to:{name:"products-details-list"},variant:"outlined",color:"primary",size:"large","append-icon":e(X)},{default:l(()=>[v(" الرجوع الى القائمة ")]),_:1},8,["append-icon"])]),a(le,{"is-loading":e(u).isPending.value,onSubmit:_},null,8,["is-loading"])],64))}});export{ye as default};
