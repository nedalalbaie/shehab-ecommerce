import{a as T,c as j,b as $}from"./orders-service-DZtj4z2A.js";import{d as z,r as A,I as Q,u as P,b as R,e as g,aG as K,R as M,c as n,j as a,k as o,h as e,V as u,f as s,g as c,t as d,aT as U,i as p,l as x,F as y,o as i,aU as I,y as L,aN as G,x as J,A as W,B as H,C as X,aR as Y,m as b,q as Z}from"./index-sE9P4Q9O.js";import{_ as ee}from"./OrderDetails.vue_vue_type_script_setup_true_lang-8rhbMVsx.js";import{c as te,S as re,s as ae}from"./check-status-1CD4zFK3.js";import{f as se}from"./format-date-q9jp0Fy1.js";import{_ as le}from"./DeleteIcon.vue_vue_type_script_setup_true_lang-1ZPx5IJG.js";import{V as oe}from"./VDialog-1Ku-f6d7.js";import{V as ie}from"./VSpacer-1dX4bruf.js";import{V as ne}from"./VAlert-TSoO0zFn.js";import"./queryString-AL1HqB06.js";const de={key:0,class:"flex items-center justify-between mt-6"},ue={class:"text-3xl flex items-center gap-2"},ce=s("div",{class:"h-6 w-6 rounded-[50%] bg-orange-300"},null,-1),me={key:0,class:"flex gap-4"},_e={key:1,class:"w-full h-96 flex items-center justify-center"},pe={class:"border-b-2 border-neutral-600 pb-1 w-fit"},fe={class:"w-4/5 flex gap-1"},ye={class:"mt-2 w-1/4 rounded-tl-lg bg-primary-100 text-white p-3 text-xl"},he={class:"flex justify-between"},ve=s("p",null,"الإجمالي :",-1),ge={key:0,class:"flex justify-between mt-2"},xe=s("p",null,"متأخرات سداد الديون :",-1),Be=z({__name:"OrderDetailsView",setup(be){const m=A();let h=0;const V=Q(),w=Number(V.params.id),{data:t,isPending:k,isError:C}=P({queryKey:["orderDetails"],queryFn:()=>T(w)}),S=r=>JSON.parse(r),O=r=>`إلغاء الطلبية ${r}# ?`,v=R(),D=g({mutationFn:j,onSuccess:()=>{v.invalidateQueries({queryKey:["orderDetails"]})},onError:r=>{console.log(r)}}),E=g({mutationFn:$,onSuccess:()=>{v.invalidateQueries({queryKey:["orderDetails"]})},onError:r=>{console.log(r)}}),N=r=>{D.mutate(r)},q=(r,_)=>{E.mutate({order_number:r,new_status:_})};return K(()=>{t.value&&(m.value=t.value.order_details.status)}),M(m,r=>{h===1?t.value&&q(t.value.order_details.order_number,r):h++}),(r,_)=>(i(),n(y,null,[a(u,{to:{name:"orders"},variant:"outlined",color:"primary",size:"large","prepend-icon":e(I)},{default:o(()=>[c(" الرجوع الى الطلبات ")]),_:1},8,["prepend-icon"]),e(t)?(i(),n("div",de,[s("div",null,[s("h1",ue,[c(" الطلب "+d(e(t).order_details.order_number)+"# - "+d(e(te)(e(t).order_details.status))+" ",1),ce]),s("p",null,d(e(se)(e(t).order_details.created_at)),1)]),e(t).order_details.status!=e(re).CANCELD?(i(),n("div",me,[a(U,{modelValue:m.value,"onUpdate:modelValue":_[0]||(_[0]=l=>m.value=l),class:"w-60",label:"تغيير حالة الطلب",placeholder:"تغيير حالة الطلب",variant:"outlined",density:"compact",items:e(ae),"item-title":"label","item-value":"value"},null,8,["modelValue","items"]),a(u,{to:{name:"edit-order",params:{id:e(t).order_details.id}},size:"large",rounded:"xl",variant:"elevated",color:"#004C6B"},{prepend:o(()=>[a(L,{icon:e(G)},null,8,["icon"])]),default:o(()=>[c(" تعديل ")]),_:1},8,["to"]),a(oe,{width:"500"},{activator:o(({props:l})=>[a(u,J(l,{size:"large",rounded:"xl",variant:"elevated",color:"error",type:"submit"}),{prepend:o(()=>[a(le,{fill:"fill-white"})]),default:o(()=>[c(" إلغاء الطلبية ")]),_:2},1040)]),default:o(({isActive:l})=>[a(W,{title:O(e(t).order_details.order_number),rounded:"lg",color:"#EFE9F5",style:{"padding-block":"1.75rem !important"}},{default:o(()=>[a(H,null,{default:o(()=>[c(" سيتم الغاء هذه الطبية بشكل نهائي، سيتلقى الزبون اشعارا يوضح ان الطبية تم الغاؤها. ")]),_:1}),a(X,null,{default:o(()=>[a(ie),a(u,{text:"لا",onClick:f=>l.value=!1},null,8,["onClick"]),a(u,{text:"نعم",onClick:f=>{l.value=!1,N(e(t).order_details.id)}},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["title"])]),_:1})])):p("",!0)])):p("",!0),e(k)?(i(),n("div",_e,[a(Y,{size:"50",width:"4",indeterminate:"",color:"primary"})])):e(C)?(i(),x(ne,{key:2,type:"error",class:"my-6",title:"خطأ في الوصول الى بيانات الطلب",text:"الرجاء اعادة المحاولة مرة أخرى."})):e(t)?(i(),x(ee,{key:3,order:e(t)},{default:o(()=>[(i(!0),n(y,null,b(e(t).products,(l,f)=>(i(),n("div",{key:l.id,class:"grid grid-cols-4 px-8 py-3"},[s("p",pe,d(l.name),1),s("p",null,d(e(t).order_details.quantity_selected[f]),1),s("div",fe,[(i(!0),n(y,null,b(S(l.hex_codes),(B,F)=>(i(),n("div",{key:F,class:"w-8 h-8 rounded-[50%] shadow-full-white border-2 flex items-end",style:Z({"background-color":`#${B}`})},null,4))),128))]),s("p",null,d(l.price),1)]))),128)),s("div",ye,[s("div",he,[ve,s("p",null,d(e(t).order_details.total_price)+" د.ل",1)]),e(t).order_details.payment_method=="installments"?(i(),n("div",ge,[xe,s("p",null,d(e(t).order_details.paid_due_value)+" د.ل",1)])):p("",!0)])]),_:1},8,["order"])):p("",!0)],64))}});export{Be as default};
